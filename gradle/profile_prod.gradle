def profiles = "prod"

if (project.hasProperty("swagger")) {
    profiles += ",swagger"
}

subprojects {
    pluginManager.withPlugin('java', {
        springBoot {
            buildInfo()
        }

        bootRun {
            args = []
        }

        processResources {
            inputs.property('version', version)
            inputs.property('springProfiles', profiles)
            filesMatching("**/application.yml") {
                filter {
                    it.replace("#project.version#", version)
                }
                filter {
                    it.replace("#spring.profiles.active#", profiles)
                }
            }
        }
        processResources.dependsOn bootBuildInfo

        bootJar.dependsOn processResources
    })
}
